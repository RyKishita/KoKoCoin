# アイデア雑記

## 操作性の改善

- エントランス
  - デュエル種類→レベルにする
    - レベルは実質ルールなので、デュエル種類→ルール選択でもある
      - ルームだけさらに階層がある
        - 専用シーンにしてもいいかも
  - 今のシーンはそのままで別に起こす。切り替えがあってもいいがメンテナンスコストもある
  - 報酬に変化が無いと選びづらそう
    - ルールに報酬が付くと考えると他に発展がありそう
  - 一方で標準ルールで遊び続ける場合で一手増える
    - レベルを頻繁に変えたいのは初期
  - 初期値がお試しであり、何も気にせず選べばいいので、初回だけは現状の方がよさそう
- オプションでUI左右反転。利き手考慮
- 例えば簡易NPCで一戦したら次のレベルが開放するなど、次にやるべき事が分かるようにする
  - コイン枚数で開放とか
    - ガチを標準にしたので合わない
- コインを選択するルールで、コインを選びやすくするため表示設定パネルを付ける

## 機能追加

- フレンド登録と対戦
  - 表示用プレイヤー名は重複がありうる。フルネームなら問題ないはず
  - QRコードはルール読み込みで実績が作れた
  - オフライン接続して交換
  - ポイント消費と報酬
    - 消費はするが報酬なし
    - 有料などで対戦を無制限にはしない
      - ポイントを買う
  - フレンド対戦画面
    - ルームと同様にする。
    - マッチメイキング機能は使わない
    - 現在遊んでいるかどうか
      - ネットワークIDで繋いでの確認で十分と思われる
  - チーム戦でフレンドと組む
- ゲーム内掲示板
  - 自由入力は一切排除している。その為、コミュニケーション方法は良く考える
    - 例えば、良い悪いだけは表明できて、コイン毎に評価するだけ
    - あるコインの組み合わせが強すぎるなら、コインセットに対して悪い評価を入れるなど
    - コインの評価に加えて、パラメータに対する評価
      - ダメージに悪い評価を付けるとか、直接攻撃の射程に付けるとか
  - ある一定の間遊んだ人だけ参加可能にすべきか
    - プレイ時間かコイン枚数か
    - さらにベテランになると、表現が強化されるとか
      - それでもフリーテキストは不可
- 人気コインのフィルタ
  - コイン使用率情報をサーバーから取得
    - プレイヤーデータ集計
      - Achievement
        - 総プレイ時間
        - 総ダメージ
        - 総経過ターン
        - 総歩行数
        - コイン毎
          - デッキ採用回数
          - デュエル中に使用された回数
    - コイン引換券使用数は、ランダムの偏り補正が役目なので見ない
  - まだそんなにコインが多くない
- ルールの集計
  - 周回用ルールや一方的な勝負になるルールを検出
  - デュエルの平均時間
  - デュエル数
  - 「いいね」評価
    - ロビーでのフィルタ「評価が低いルールの除外」
  - カスタムルールやルームでのデュエル後に評価を出す
- 実績
  - 与えたダメージの、ダメージ種類。
  - 受けたダメージ。ダメージ種類
    - ユーザー公開はせず分析用
  - コインサイズ別とかコイン別とか、細かい事を言うと沢山あるので見送り
- 同じコイン3枚でコイン引換券に出来るが、デッキに入れられる3枚を残そうと思うと6枚にならないと交換できない。4枚所持など中途半端にあるコインを変えたい
  - ベテラン向け機能なので優先度は低い
  - コインを選択するわけではないので、UIは別
  - 処理を選択
    - 3の倍数以上ある余剰コインのみをチケットにする機能
      - 所持枚数ソートである程度出来るので優先度は低い
    - 全ての余剰をチケットにする機能
      - 前項の3の倍数処理をしてから処理
      - この場合の交換比率は低くする。5枚で1枚
      - 一枚も交換されないなら処理しない
      - 割り切れない場合にどれを残すかが決まらない
        - とりあえずランダムで残す
  - オンラインコインに対する実装が面倒

## 自動操作の高度化

- 配置の優先順位判定で、設置後に効果でダメージが上昇する場合にその効果を考慮されていない
  - またその逆で、設置済みのコインが入れ替えで捨てられる事でダメージが下がる場合
  - おかしい例
    - AlienMachine を置いた後に AlienDragon を置く事がある
      - AlienDragon が100だけ大きく、かつ効果も異次元×100アップなので
    - ポイズンフラワーを置いた後に、プランターを置く
      - ポイズンフラワーの設置分のダメージを加算しているため
  - 置き換えではなく、次のターン以降に空きエリアに置く事でのダメージアップをどう評価するか
    - ダイス目全てが空きエリアならダメージそのまま、半分が置けるならダメージ半分として、置き換えとのダメージアップを比較
      - 次のターンなので評価を下げる必要がある
- サポートコイン選択において、より効果が高いものを使用させたい
  - ProcessAutoSelectAdjunct
  - 行動評価方法の確立。複数手の評価
- デッキ内容による優先変更
  - テーマのキーとなるコイン検出
    - デッキのテーマ検出
- 場の評価による選択システム
  - DuelDataから算出
  - 全ての手を実行して、結果として変化したDuelDataから得られた値が最も高いものを採用
    - DuelManagerに依存しているが、多数の外部参照があるので、ゲームのメインループの分離から
  - リソースの評価が難しい。現在のステップ以外も関係するため
- デュエルルールのmanyActionの対応
  - 複数ドロー。1ドロー後に、手持ちコインではターンリソースを使い切れないなら再度引く。
  - ターン全体としてターンリソースを使い切るようにコインを選択
  - リソース上限いっぱいまで使い切る
    - 移動によって補充されるので、使い切るのは第1使用ステップ
  - 手持ちの中で最も有効なコインを決めて、その分のリソースを残すように行動する
- 手持ちコインの使用条件になっている設置コインの上に止まったときは、何もしないようにする
  - 設置コインを優先しているので今のところは問題ないが、将来を考える
- コイン効果により、山コインまたは捨てコインからから取得して設置コインに重ねる場合に選択されるコインのロジック。
  - 現状はサイズの大きいものから使用している

### 自動操作の高度化-拡張

- CPU性格による優先変更
  - 貧乏性ならサイズの大きいコインの使用をためらうなど
  - 選択UI
  - ストーリーなどの拡張時
  - SelectAdjunctCoinAreaSideで、相手へのダメージが高くなるように変更するか、それとも自身のダメージを減らすように変更するか
    - CPU性格及びデッキによる。遅いデッキなら後者
- 自身のオートプレイ時の思考ルーチン設定
  - デッキに対してセット
  - 常にオートプレイの設定。対戦前に選択させるのも一つの手
    - さらに自動マッチングがあると、マッチングする限りはどんどん対戦される
      - オートプレイ同士をマッチングするかどうか

## キャラクター機能

- 外見のみ変更
  - コインモデルをそのまま使用
  - 特別なモデルは販売。オンライン対戦以外での収益の柱とするかも
- アニメーション
  - 勝利
  - 敗北
  - 引き分け
  - ダメージ
  - ドロー
- メリットとデメリット
  - 基本的にそれらだけ比較するとデメリットの方が重くする。この事で特徴なしの選択も意味あるものにする
  - 候補
    - 直接攻撃コインアップ、設置コインダウン
    - 全ダメージアップ、防御コインを使用できない
    - 歩数が1減る、リソース減少
    - ステータスダメージ無効、ステータスによる動作阻害効果発生までの数が減少
    - タグ〇の効果を上昇、タグ〇を持つコインしかデッキに入れられない
- コイン選択ルーチンの調整
  - コイン入れ替えサポートコインについて、自分のダメージを上げるのか相手のダメージを下げるのか

## 複数人対戦・チーム戦

- 順番の決定方法
  - チームAとBがそれぞれ二人ずついるとしたらABABが公平だと思われるが、Aの二人は始めのAか後のAのどちらになるか
- ホストが一人の待ち受けしかしていない
- TODO処理
  - DuelAreaController
    - GetPlayerPosition
      - 同じマスにより多くのプレイヤーが止まった時
- ClearPlayerCondition は bCoinOwner がfalseなら、プレイヤーの選択が必要になる
  - プレイヤーを対象に取るサポートコインの選択ステップが必要
    - とりあえず自分に固定。将来検討
  - ProgressTurnALLSetCoinsByPlayer は自分以外全て。ClearPlayerCondition も同じ解釈にはできるが、影響が大きい
    - ProgressTurnHandCoinsByPlayer
    - RemoveCoinStatusALLSetCoinsByPlayer
- 直接攻撃コインの相手は対戦相手としているが、複数人の対戦を考えて選択を考慮する。選択肢が一つしかない場合に現状通り相手になる
  - サポートコインも同じ
- 2ラインでそれぞれ戦って、任意のタイミングで仲間と入れ替えられる
  - 代償を付けたい
